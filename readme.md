# Maprox Pipe

**Maprox Pipe** - —ç—Ç–æ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç GPS/–ì–õ–û–ù–ê–°–° —Ç—Ä–µ–∫–µ—Ä–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –¥–≤—É—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö: –∫–∞–∫ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- **Balancer** (`balancer.py`) - –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤ –º–µ–∂–¥—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏
- **Handlers** - –º–æ–¥—É–ª–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ —Ç—Ä–µ–∫–µ—Ä–æ–≤
- **Kernel** - —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã —Å TCP-—Å–µ—Ä–≤–µ—Ä–æ–º, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **Database** - –º–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **Broker** - —Å–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π (AMQP/RabbitMQ)

## üì° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã —Ç—Ä–µ–∫–µ—Ä–æ–≤:

- **ATrack AX5** (–ø–æ—Ä—Ç 21300)
- **AutoLink II** (–ø–æ—Ä—Ç 21301)
- **Galileo** (–ø–æ—Ä—Ç 21001)
- **GlobalSat** (TR151, TR203, TR206, TR600, GTR128)
- **GlobusGPS** (–ø–æ—Ä—Ç 21010)
- **Naviset** (GT10, GT20)
- **Teltonika** (FMxxxx, GH3000)

## üöÄ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### 1. –†–µ–∂–∏–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –æ—á–µ—Ä–µ–¥–µ–π AMQP.

```bash
# –ó–∞–ø—É—Å–∫ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
python3 balancer.py
```

### 2. –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—Ç—É.

```bash
# –ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è Galileo
python3 main.py -d galileo.default -p 21001

# –ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è GlobalSat TR206
python3 main.py -d globalsat.tr206 -p 20101
```

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

1. **–ó–∞–ø—É—Å–∫ –≤—Å–µ–π —Å—Ç–µ–∫–∞:**
```bash
cd conf/docker
./docker_stack_start.sh
```

2. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–µ–∫–∞:**
```bash
cd conf/docker
./docker_stack_stop.sh
```

## ‚ò∏Ô∏è –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Kubernetes

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Kubernetes –∫–ª–∞—Å—Ç–µ—Ä (–≤–µ—Ä—Å–∏—è 1.19+)
- kubectl –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –∫–ª–∞—Å—Ç–µ—Ä—É
- Redis –∏ RabbitMQ —É–∂–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

1. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—Å–µ–π —Å—Ç–µ–∫–∏:**
```bash
kubectl apply -f k8s/all.yaml
```

2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç:**

**Linux/macOS:**
```bash
chmod +x k8s/deploy.sh
./k8s/deploy.sh deploy    # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
./k8s/deploy.sh status    # –°—Ç–∞—Ç—É—Å
./k8s/deploy.sh logs galileo  # –õ–æ–≥–∏
./k8s/deploy.sh delete    # –£–¥–∞–ª–µ–Ω–∏–µ
```

**Windows:**
```cmd
k8s\deploy.cmd deploy     # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
k8s\deploy.cmd status     # –°—Ç–∞—Ç—É—Å
k8s\deploy.cmd logs galileo  # –õ–æ–≥–∏
k8s\deploy.cmd delete     # –£–¥–∞–ª–µ–Ω–∏–µ
```

### –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### –ó–∞–ø—É—Å–∫ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞:
```bash
docker run -d --name pipe-balancer \
  -e PIPE_ENVIRONMENT=production \
  -e PIPE_HOSTNAME=your-hostname.com \
  -e PIPE_HOSTIP=192.168.1.100 \
  -e REDIS_HOST=redis \
  -e REDIS_PASS=your-redis-password \
  -e AMQP_CONNECTION="amqp://admin:your-rabbitmq-password@rabbitmq//" \
  --link redis \
  --link rabbitmq \
  maprox/pipe python3 balancer.py
```

#### –ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ Galileo:
```bash
docker run -d --name pipe-galileo \
  -e PIPE_ENVIRONMENT=production \
  -e PIPE_HOSTNAME=your-hostname.com \
  -e PIPE_HOSTIP=192.168.1.100 \
  -e PIPE_HANDLER=galileo.default \
  -e PIPE_PORT=21001 \
  -e REDIS_HOST=redis \
  -e REDIS_PASS=your-redis-password \
  -e AMQP_CONNECTION="amqp://admin:your-rabbitmq-password@rabbitmq//" \
  --link redis \
  --link rabbitmq \
  -p 21001:21001 \
  maprox/pipe
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–°–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

- **Redis** - –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **RabbitMQ** - –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (`conf/pipe.conf`)

```ini
[pipe]
environment=production
hostname=your-hostname.com
hostip=192.168.1.100
socketPacketLength=8192

[redis]
host=127.0.0.1
port=6379
password=your-redis-password

[amqp]
connection=amqp://admin:your-rabbitmq-password@127.0.0.1//
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (`conf/handlers/galileo.default.conf`)

```ini
[general]
port=21001

[settings]
handler=galileo.default
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `PIPE_ENVIRONMENT` - —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (production/development)
- `PIPE_HOSTNAME` - –∏–º—è —Ö–æ—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: your-hostname.com)
- `PIPE_HOSTIP` - IP –∞–¥—Ä–µ—Å —Ö–æ—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100)
- `PIPE_HANDLER` - –∏–º—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- `PIPE_PORT` - –ø–æ—Ä—Ç –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è
- `REDIS_HOST` - —Ö–æ—Å—Ç Redis —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: redis –∏–ª–∏ 127.0.0.1)
- `REDIS_PORT` - –ø–æ—Ä—Ç Redis —Å–µ—Ä–≤–µ—Ä–∞ (–æ–±—ã—á–Ω–æ 6379)
- `REDIS_PASS` - –ø–∞—Ä–æ–ª—å Redis (–Ω–∞–ø—Ä–∏–º–µ—Ä: your-redis-password)
- `AMQP_CONNECTION` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `amqp://username:password@host:port//`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. –õ–æ–≥–∏ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `-l`:

```bash
# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ stdout
python3 main.py -l stdout

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª
python3 main.py -l conf/logs.conf
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `debug/` –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤:

```bash
# –¢–µ—Å—Ç –∫–ª–∏–µ–Ω—Ç–∞ Galileo
python3 debug/client_galileo.py

# –¢–µ—Å—Ç –∫–ª–∏–µ–Ω—Ç–∞ GlobalSat
python3 debug/client_globalsat.py
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
pipe/
‚îú‚îÄ‚îÄ balancer.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
‚îú‚îÄ‚îÄ kernel/              # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ balancer.py      # –õ–æ–≥–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ server.py        # TCP —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ config.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ starter.py       # –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ lib/                 # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ handlers/        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ broker.py        # –°–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ packets.py       # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ conf/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ handlers/        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ docker/          # Docker —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ k8s/                 # Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ configmap.yaml   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ balancer.yaml    # –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ galileo.yaml     # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Galileo
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh        # –°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (Linux/macOS)
‚îÇ   ‚îú‚îÄ‚îÄ deploy.cmd       # –°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (Windows CMD)
‚îÇ   ‚îî‚îÄ‚îÄ deploy.ps1       # –°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (Windows PowerShell)
‚îî‚îÄ‚îÄ debug/               # –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã
```

## üîç –û—Ç–ª–∞–¥–∫–∞

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `debug/`:

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏
python3 main.py -l stdout -d galileo.default -p 21001
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

Copyright 2009-2025, Maprox LLC

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ Maprox LLC.

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Redis –∏ RabbitMQ –∑–∞–ø—É—â–µ–Ω—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

